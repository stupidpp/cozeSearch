<!--pages/shared/shared.wxml-->
<view class="shared-container">
  <view wx:if="{{loading}}" class="loading-container">
    <text class="loading-text">加载中...</text>
  </view>
  
  <view wx:elif="{{!sharedData}}" class="error-container">
    <text class="error-text">分享内容不存在</text>
    <button class="back-btn" bindtap="backToApp">返回应用</button>
  </view>
  
  <view wx:else class="content-container">
    <!-- 分享标题 -->
    <view class="shared-header">
      <text class="shared-title">科研合作推荐结果</text>
      <text class="shared-time">分享时间：{{formattedTimestamp}}</text>
    </view>
    
    <!-- 分享的消息内容 -->
    <view class="messages-container">
      <block wx:for="{{messages}}" wx:for-item="item" wx:key="id">
        <!-- 用户消息 -->
        <view wx:if="{{item.type === 'user'}}" class="user-message">
          <view class="message-content">{{item.content}}</view>
        </view>
        
        <!-- 助手消息 -->
        <view wx:elif="{{item.type === 'assistant'}}" class="assistant-message">
          <view wx:if="{{item.content}}" class="message-content">{{item.content}}</view>
          <!-- 富文本消息 -->
          <view wx:if="{{item.isRichText && item.content}}">
            <towxml nodes="{{item.formattedContent}}"></towxml>
          </view>
          <!-- 普通文本消息 -->
          <view wx:elif="{{item.content && !item.isRichText}}">
            {{item.content}}
          </view>
  
  
          <!-- 教授卡片 -->
          <view wx:if="{{item.cardData}}" class="card-container">
            <custom-professor-list cardData="{{item.cardData}}" readOnly="{{true}}"></custom-professor-list>
          </view>
        </view>
      </block>
    </view>
    
    <!-- 底部操作 -->
    <view class="shared-footer">
      <button class="back-btn" bindtap="backToApp">打开小程序体验</button>
      <button class="share-btn" open-type="share">转发给朋友</button>
    </view>
  </view>
</view>
